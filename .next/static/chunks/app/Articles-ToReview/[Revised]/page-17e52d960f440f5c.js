(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[501],{5227:function(e,t,s){Promise.resolve().then(s.bind(s,8677))},3969:function(e,t,s){"use strict";var a=s(7437),r=s(2265),i=s(3569);t.Z=e=>{let{article:t,User:s}=e,[o,l]=(0,r.useState)(""),[c,n]=(0,r.useState)(!1),[d,u]=(0,r.useState)([]),[h,m]=(0,r.useState)([]),{isSignedIn:p,user:f,isLoaded:b}=(0,i.aF)(),[x,v]=(0,r.useState)();console.log(f),(0,r.useEffect)(()=>{(async()=>{let e=await fetch("http://localhost:1337/api/comments?populate=*&filters[ArticleId][$eq]=".concat(t.id));m((await e.json()).data)})()},[]),(0,r.useEffect)(()=>{(async()=>{let e=await fetch("http://localhost:1337/api/users?populate=*&filters[email][$eq]=".concat(f.primaryEmailAddress.emailAddress)),t=await e.json();console.log(t),v(t)})()},[]);let g=async e=>{if(e.preventDefault(),o.trim()){let e={data:{RecieverEmail:t.attributes.Email,Senderusername:x[0].username,RecieverUsername:t.attributes.UserName,State:c,Comment:o,ArticleId:t.id}};try{let t=await fetch("http://localhost:1337/api/comments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to create comment");let s=await t.json();u([...d,{text:o,checked:c,id:s.data.id}]),l(""),n(!1),alert("Comment sent successfully!")}catch(e){console.error("Error creating comment:",e)}}else alert("Please enter a comment.")},j=async(e,t)=>{try{if(!(await fetch("http://localhost:1337/api/comments/".concat(e),{method:"DELETE",headers:{"Content-Type":"application/json"}})).ok)throw Error("Failed to delete comment");let s=[...d];s.splice(t,1),u(s)}catch(e){console.error("Error deleting comment:",e)}},w=(e,t)=>(0,a.jsx)("div",{style:{overflow:"hidden",maxHeight:"90px"},children:e},t);return(0,a.jsxs)("div",{children:[(0,a.jsxs)("form",{onSubmit:g,children:[(0,a.jsx)("textarea",{value:o,onChange:e=>{l(e.target.value)},className:"w-full p-1 border rounded focus:outline-none",rows:"3",placeholder:"Write a comment..."}),(0,a.jsx)("button",{type:"submit",className:"ml-2 mb-3 text-blue-500",children:"Comment"})]}),(0,a.jsx)("div",{children:d.map((e,t)=>(0,a.jsxs)("div",{className:"mb-2 p-2 border rounded",children:[(0,a.jsxs)("p",{children:[" Editor : ",x[0].username]}),(0,a.jsx)("p",{children:w(e.text,t)}),(0,a.jsxs)("p",{children:["Status: ",e.checked?"Author has Fixed it ":"Author Did Not Fix it "]}),(0,a.jsx)("button",{onClick:()=>j(e.id,t),className:"ml-2 text-red-500",children:"Delete"})]},e.id))})]})}},8677:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var a=s(7437),r=s(3743),i=s(2265),o=s(6463),l=s(3969),c=s(3569),n=function(e){let{article:t,User:s}=e,{isSignedIn:r,user:o,isLoaded:n}=(0,c.aF)(),[d,u]=(0,i.useState)([]),[h,m]=(0,i.useState)();if(!s)return(0,a.jsx)("div",{className:"flex justify-center h-screen w-full items-center",children:(0,a.jsx)("l-waveform",{size:"35",stroke:"3.5",speed:"1",color:"black"})});(0,i.useEffect)(()=>{(async()=>{let e=await fetch("http://localhost:1337/api/comments?populate=*&filters[ArticleId][$eq]=".concat(t.id),{cache:"no-store"});u((await e.json()).data)})()},[t.id]);let p=(e,t)=>(0,a.jsx)("div",{style:{overflow:"hidden",maxHeight:"90px"},children:e},t),f=async(e,t)=>{try{if(!(await fetch("http://localhost:1337/api/comments/".concat(d[t].id),{method:"DELETE",headers:{"Content-Type":"application/json"}})).ok)throw Error("Failed to delete comment");let e=[...d];e.splice(t,1),u(e)}catch(e){console.error("Error deleting comment:",e)}};if(d){var b;console.log(null===(b=d[0])||void 0===b?void 0:b.attributes.State)}let x=s.email,[v,g]=(0,i.useState)(null),[j,w]=(0,i.useState)([]),[y,E]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{(async()=>{let e=await fetch("/api/ClientAvatar");m((await e.json()).data)})()},[]),(0,i.useEffect)(()=>{h&&g(h.find(e=>e.emailAddresses&&e.emailAddresses.some(e=>e.emailAddress===x)))},[h,x]),h)?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"PictureAndBio",children:[(0,a.jsx)("img",{src:null==v?void 0:v.imageUrl,className:"avatar shadow-lg",alt:"Avatar"}),(0,a.jsxs)("h1",{className:"SubmittedBy text-xl font-bold dark:text-white",children:["Submitted By : ",null==s?void 0:s.username]}),(0,a.jsx)("div",{className:"mb-4 mt-4",children:(0,a.jsx)("button",{onClick:()=>{w([...j,{id:Date.now(),text:"",checked:!1}])},className:"p-2 bg-green-500 text-white rounded-full",children:"+ Add Comment"})}),(0,a.jsxs)("div",{className:"mt-4",children:[j.map((e,r)=>(0,a.jsx)(l.Z,{article:t,User:s},e.id)),null==d?void 0:d.map((e,t)=>(0,a.jsxs)("div",{className:"mb-2 p-2 border rounded",children:[e.attributes.isEditor?(0,a.jsxs)("p",{children:["Editor: ",e.attributes.Senderusername]}):(0,a.jsxs)("p",{children:["Reviewer: ",e.attributes.Senderusername]}),(0,a.jsx)("p",{children:p(e.attributes.Comment,t)}),(0,a.jsxs)("p",{children:["Status: ",e.attributes.State?"User has Fixed it":"User Hasn't Fixed it"]}),(0,a.jsx)("button",{onClick:()=>f(e.id,t),className:"ml-2 text-red-500",children:"Delete"})]},e.id))]})]})}):(0,a.jsx)("div",{className:"flex justify-center h-screen w-full items-center",children:(0,a.jsx)("l-waveform",{size:"35",stroke:"3.5",speed:"1",color:"black"})})},d=s(3705),u=s(2214),h=s(3922),m=s(9930),p=s(2375);s(7250);var f=function(e){let{article:t}=e,[s,r]=(0,i.useState)(!1),[o,l]=(0,i.useState)(""),{isLoaded:n,isSignedIn:f,user:b}=(0,c.aF)(),[x,v]=(0,i.useState)(!1),[g,j]=(0,i.useState)();(0,i.useEffect)(()=>{t&&t.attributes&&t.attributes.Bbody&&l(t)},[t]),(0,i.useEffect)(()=>{!x&&n&&f&&fetch("http://localhost:1337/api/users?filters[email][$eq]=".concat(b.primaryEmailAddress.emailAddress)).then(e=>{if(!e.ok)throw Error("Failed to fetch users");return e.json()}).catch(e=>{console.error("Error fetching users:",e)})},[n,f,x]);let w=(0,d.jE)({editable:s,content:"".concat(t.attributes.Bbody),extensions:[u.Z,m.ZP.configure({openOnClick:!1,autolink:!0}),h.ZP.configure({allowBase64:!0}),p.Z]});if((0,i.useEffect)(()=>{if(w){w.setEditable(s);let e=()=>{j(w.getHTML())};return w.on("update",e),()=>{w.off("update",e)}}},[w,s]),!w)return(0,a.jsxs)("div",{className:"flex justify-center h-screen w-full items-center",children:["  ",(0,a.jsx)("l-waveform",{size:"35",stroke:"3.5",speed:"1",color:"black"})]});let y=async e=>{e.stopPropagation();try{if(!(await fetch("http://localhost:1337/api/articles/".concat(o.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:{ReviewApproved:!0}})})).ok)throw Error("Failed to create article");alert("Article Sent to the Editor  successfully!")}catch(e){console.error("Error creating article:",e)}};return(0,a.jsxs)("div",{className:"ReaderTipTapthings w-[100%]",children:[(0,a.jsx)("div",{className:"mr-5",children:(0,a.jsx)("div",{className:"mb-5  flex justify-end",children:(0,a.jsx)("div",{class:"flex   ",children:(0,a.jsx)("div",{children:(0,a.jsx)("button",{onClick:y,className:"  rounded-md bg-green-500  px-5 py-2.5 text-sm font-medium text-black transition hover:bg-teal-700 ml-5 group cursor-pointer outline-none",title:"Add New",children:"Send to the Editor"})})})})}),(0,a.jsx)("div",{className:"w-full ml-1 px-0",children:(0,a.jsx)(d.kg,{style:{whiteSpace:"pre-line"},editor:w})}),(0,a.jsx)("div",{})]})},b=s(2358),x=function(e){let{params:t}=e;(0,o.usePathname)(),b.Z.register();let[s,l]=(0,i.useState)(null),[c,d]=(0,i.useState)(null),[u,h]=(0,i.useState)(!0);return((0,i.useEffect)(()=>{(async()=>{try{let e=await r.Z.getArticleById(null==t?void 0:t.Revised);l(e.data.data);let s=await r.Z.getUserById(null==e?void 0:e.data.data.attributes.users_permissions_user.data.id);d(s.data)}catch(e){console.error("Error fetching article data:",e)}finally{h(!1)}})()},[null==t?void 0:t.articleId]),u)?(0,a.jsxs)("div",{className:"flex justify-center h-screen w-full items-center",children:["  ",(0,a.jsx)("l-waveform",{size:"35",stroke:"3.5",speed:"1",color:"black"})]}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"pagecss",children:[(0,a.jsx)(n,{article:s,User:c}),(0,a.jsx)(f,{article:s})]})})}},3743:function(e,t,s){"use strict";let{default:a}=s(2759);t.Z={getReviwersAppeal:()=>a.get("/appeals?populate=*"),getLatestArticles:()=>a.get("/articles?populate=*"),getArticleById:e=>a.get("/articles/".concat(e,"?populate=*")),getUserById:e=>a.get("/users/".concat(e,"?populate=*"))}},2759:function(e,t,s){"use strict";s.r(t);let{default:a}=s(4681),r=a.create({baseURL:"http://localhost:1337/api",headers:{Authorization:"Bearer ".concat("3d1304063436599485a0293fe974c8293f1785cc3ffbfca8f680c0306f57b9f84e2a0448114eebda620b7c805cedcd2a92fec9199d422aac04fe60bb11826615059bd101d677665b60ca23e0c471974f4a92fbdb48c112fb791f4e4808178f21783905fa2679092f4219dfafe70b67952de3a75524bac26e5d3c7c0a8d81c730")}});t.default=r},6463:function(e,t,s){"use strict";var a=s(1169);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},7250:function(){},2358:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});class a extends HTMLElement{_propsToUpgrade={};shadow;template;defaultProps;isAttached=!1;constructor(){super(),this.shadow=this.attachShadow({mode:"open"}),this.template=document.createElement("template")}storePropsToUpgrade(e){e.forEach(e=>{this.hasOwnProperty(e)&&void 0!==this[e]&&(this._propsToUpgrade[e]=this[e],delete this[e])})}upgradeStoredProps(){Object.entries(this._propsToUpgrade).forEach(([e,t])=>{this.setAttribute(e,t)})}reflect(e){e.forEach(e=>{Object.defineProperty(this,e,{set(t){"string,number".includes(typeof t)?this.setAttribute(e,t.toString()):this.removeAttribute(e)},get(){return this.getAttribute(e)}})})}applyDefaultProps(e){this.defaultProps=e,Object.entries(e).forEach(([e,t])=>{this[e]=this[e]||t.toString()})}}var r=":host{align-items:center;display:inline-flex;flex-shrink:0;height:calc(var(--uib-size)*.9);justify-content:center;width:var(--uib-size)}:host([hidden]){display:none}.container{align-items:center;display:flex;height:calc(var(--uib-size)*.9);justify-content:space-between;width:var(--uib-size)}.bar{background-color:var(--uib-color);height:100%;transition:background-color .3s ease;width:var(--uib-stroke)}.bar:first-child{animation:grow var(--uib-speed) ease-in-out calc(var(--uib-speed)*-.45) infinite}.bar:nth-child(2){animation:grow var(--uib-speed) ease-in-out calc(var(--uib-speed)*-.3) infinite}.bar:nth-child(3){animation:grow var(--uib-speed) ease-in-out calc(var(--uib-speed)*-.15) infinite}.bar:nth-child(4){animation:grow var(--uib-speed) ease-in-out infinite}@keyframes grow{0%,to{transform:scaleY(.3)}50%{transform:scaleY(1)}}";class i extends a{_attributes=["size","color","speed","stroke"];size;color;speed;stroke;static get observedAttributes(){return["size","color","speed","stroke"]}constructor(){super(),this.storePropsToUpgrade(this._attributes),this.reflect(this._attributes)}connectedCallback(){this.upgradeStoredProps(),this.applyDefaultProps({size:35,color:"black",speed:1,stroke:3.5}),this.template.innerHTML=`
      <div class="container">
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
      </div>
      <style>
        :host{
          --uib-size: ${this.size}px;
          --uib-color: ${this.color};
          --uib-speed: ${this.speed}s;
          --uib-stroke: ${this.stroke}px;
        }
        ${r}
      </style>
    `,this.shadow.replaceChildren(this.template.content.cloneNode(!0))}attributeChangedCallback(){let e=this.shadow.querySelector("style");e&&(e.innerHTML=`
      :host{
        --uib-size: ${this.size}px;
        --uib-color: ${this.color};
        --uib-speed: ${this.speed}s;
        --uib-stroke: ${this.stroke}px;
      }
      ${r}
    `)}}var o={register:(e="l-waveform")=>{customElements.get(e)||customElements.define(e,class extends i{})},element:i}}},function(e){e.O(0,[193,572,902,569,681,388,971,23,744],function(){return e(e.s=5227)}),_N_E=e.O()}]);